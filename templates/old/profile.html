{% extends "layout.html" %}
{% block styles %}
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='mod.css') }}" />
{% endblock %}
{% block scripts %}
<script>
window.username = "{{profile.username}}";
</script>
<script src="/static/profile.js"></script>
{% endblock %}
{% block title %}
<title>{{ profile.username }} on {{ site_name }}</title>
{% endblock %}
{% block body %}
<form action="/profile/{{ profile.username }}/edit" method="POST">
    <div class="header upload-well scrollable" id="header-well" style="
        {%if profile.backgroundMedia%}background-image: url({{ profile.backgroundMedia }});{%endif%}
        background-position: 0 {% if profile.bgOffsetY %}{{ profile.bgOffsetY }}px{% else %}0{% endif %};
        background-color: #ddd;"
        data-event="upload_bg"
        data-scroll-y="bg-offset-y">
        <a href="#" class="upload-link">Click to upload header</a>
        <input type="file">
        <div class="upload-progress"></div>
        <div class="directions"><span class="glyphicon glyphicon-resize-vertical"></span>Click and drag to move <span class="glyphicon glyphicon-resize-vertical"></span></div>
    </div>
    <input type="hidden" name="backgroundMedia" id="backgroundMedia" value="{{ profile.backgroundMedia }}">
    <input type="hidden" name="bg-offset-y" id="bg-offset-y" value="{% if profile.bgOffsetY %}{{ profile.bgOffsetY }}{% endif %}">
    <div class="container lead">
        <div class="row">
            <div class="col-md-8">
                <h1 title="{{ profile.username }}">{{ profile.username }}<small> edit your profile</small></h1>
            </div>
            <div class="col-md-2">
                <input type="submit" value="Save Changes" class="btn btn-primary btn-block" />
            </div>
            <div class="col-md-2">
                <a href="/profile/{{ profile.username }}" class="btn btn-default btn-block">Cancel</a>
            </div>
        </div>
    </div>
    <div class="info-list">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <p>Let people know where to find you on other sites (optional):</p>
                    <br />
                    <div class="timeline-centered">
                        <div class="timeline-entry">
                            <div class="timeline-entry-inner">
                                <div class="timeline-icon" style="display: inline-block;">
                                    <span class="glyphicon glyphicon-link"></span>
                                </div>
                                    <h2 style="margin-top: 0;padding-bottom: 0; margin-bottom: 0;left: 5mm;position: relative;top: -5.5mm;">
                                        <span class="text-muted">
                                           Forum:
                                        </span>
                                    </h2>
                                        <input type="text" class="form-control" name="forum-username" value="{%if profile.forumUsername%}{{ profile.forumUsername }}{%endif%}"  style="width: 65%;display: inline-block;float: left;margin-left: 5mm;top: -5.5mm;position: relative;" /><span class="active-box" style="top: -4mm;position: relative;display: inline-block;float: right;vertical-align: middle;"><input type="checkbox" value="1" name="showForumName"  style="display: inline-block;"{% if profile.showForumName %}checked{% endif %} /><label for="showForumName" class="text-muted"  style="display: inline-block;vertical-align: middle;">&nbsp;Make public</label></span>
                            </div>
                        </div>
                        <div class="timeline-entry">
                            <div class="timeline-entry-inner">
                                <div class="timeline-icon" style="display: inline-block;">
                                    <span class="glyphicon glyphicon-link"></span>
                                </div>
                                    <h2 style="margin-top: 0;padding-bottom: 0; margin-bottom: 0;left: 5mm;position: relative;top: -5.5mm;">
                                        <span class="text-muted">
                                           Twitter:
                                        </span>
                                    </h2>
                                        <input type="text" class="form-control" name="twitter-username" value="{%if profile.twitterUsername%}{{ profile.twitterUsername }}{%endif%}"  style="width: 65%;display: inline-block;float: left;margin-left: 5mm;top: -5.5mm;position: relative;" /><span class="active-box" style="top: -4mm;position: relative;display: inline-block;float: right;vertical-align: middle;"><input type="checkbox" value="1" name="showTwitterName"  style="display: inline-block;" {% if profile.showTwitterName %}checked{% endif %} /><label for="showTwitterName" class="text-muted"  style="display: inline-block;vertical-align: middle;">&nbsp;Make public</label></span>
                            </div>
                        </div>
                        <div class="timeline-entry">
                            <div class="timeline-entry-inner">
                                <div class="timeline-icon" style="display: inline-block;">
                                    <span class="glyphicon glyphicon-link"></span>
                                </div>
                                    <h2 style="margin-top: 0;padding-bottom: 0; margin-bottom: 0;left: 5mm;position: relative;top: -5.5mm;">
                                        <span class="text-muted">
                                           Reddit:
                                        </span>
                                    </h2>
                                        <input type="text" class="form-control" name="reddit-username" value="{%if profile.redditUsername%}{{ profile.redditUsername }}{%endif%}"  style="width: 65%;display: inline-block;float: left;margin-left: 5mm;top: -5.5mm;position: relative;" /><span class="active-box" style="top: -4mm;position: relative;display: inline-block;float: right;vertical-align: middle;"><input type="checkbox" value="1" name="showRedditName"  style="display: inline-block;" {% if profile.showRedditName %}checked{% endif %} /><label for="showRedditName" class="text-muted"  style="display: inline-block;vertical-align: middle;">&nbsp;Make public</label></span>
                            </div>
                        </div>
                        <div class="timeline-entry">
                            <div class="timeline-entry-inner">
                                <div class="timeline-icon" style="display: inline-block;">
                                    <span class="glyphicon glyphicon-link"></span>
                                </div>
                                    <h2 style="margin-top: 0;padding-bottom: 0; margin-bottom: 0;left: 5mm;position: relative;top: -5.5mm;">
                                        <span class="text-muted">
                                           IRC:
                                        </span>
                                    </h2>
                                        <input type="text" class="form-control" name="irc-nick" value="{%if profile.ircNick%}{{ profile.ircNick }}{%endif%}"  style="width: 65%;display: inline-block;float: left;margin-left: 5mm;top: -5.5mm;position: relative;" /><span class="active-box" style="top: -4mm;position: relative;display: inline-block;float: right;vertical-align: middle;"><input type="checkbox" value="1" name="showIRCName"  style="display: inline-block;" {% if profile.showIRCName %}checked{% endif %} /><label for="showIRCName" class="text-muted"  style="display: inline-block;vertical-align: middle;">&nbsp;Make public</label></span>
                            </div>
                        </div>
                        <div class="timeline-entry">
                            <div class="timeline-entry-inner">
                                <div class="timeline-icon" style="display: inline-block;">
                                    <span class="glyphicon glyphicon-link"></span>
                                </div>
                                    <h2 style="margin-top: 0;padding-bottom: 0; margin-bottom: 0;left: 5mm;position: relative;top: -5.5mm;">
                                        <span class="text-muted">
                                           Youtube:
                                        </span>
                                    </h2>
                                        <input type="text" class="form-control" name="youtube-username" value="{%if profile.youtubeUsername%}{{ profile.youtubeUsername }}{%endif%}"  style="width: 65%;display: inline-block;float: left;margin-left: 5mm;top: -5.5mm;position: relative;" /><span class="active-box" style="top: -4mm;position: relative;display: inline-block;float: right;vertical-align: middle;"><input type="checkbox" value="1" name="showYoutubeName"  style="display: inline-block;" {% if profile.showYoutubeName %}checked{% endif %} /><label for="showYoutubeName" class="text-muted"  style="display: inline-block;vertical-align: middle;">&nbsp;Make public</label></span>
                            </div>
                        </div>
                        <div class="timeline-entry">
                            <div class="timeline-entry-inner">
                                <div class="timeline-icon" style="display: inline-block;">
                                    <span class="glyphicon glyphicon-link"></span>
                                </div>
                                    <h2 style="margin-top: 0;padding-bottom: 0; margin-bottom: 0;left: 5mm;position: relative;top: -5.5mm;">
                                        <span class="text-muted">
                                            Twitch:
                                        </span>
                                    </h2>
                                        <input type="text" class="form-control" name="twitch-username" value="{%if profile.twitchUsername%}{{ profile.twitchUsername }}{%endif%}"  style="width: 65%;display: inline-block;float: left;margin-left: 5mm;top: -5.5mm;position: relative;" /><span class="active-box" style="top: -4mm;position: relative;display: inline-block;float: right;vertical-align: middle;"><input type="checkbox" value="1" name="showTwitchName"  style="display: inline-block;" {% if profile.showTwitchName %}checked{% endif %} /><label for="showTwitchName" class="text-muted"  style="display: inline-block;vertical-align: middle;">&nbsp;Make public</label></span>
                            </div>
                        </div>
                        <div class="timeline-entry" style="">
                            <div class="timeline-entry-inner" style="background: #F5F5F5;">
                                <div class="timeline-icon" style="display: inline-block;">
                                    <span class="glyphicon glyphicon-link"></span>
                                </div>
                                    <h2 style="margin-top: 0;padding-bottom: 0; margin-bottom: 0;left: 5mm;position: relative;top: -5.5mm;">
                                        <span class="text-muted">
                                            Facebook:
                                        </span>
                                    </h2>
                                        <input type="text" class="form-control" name="facebook-username" value="{%if profile.facebookUsername%}{{ profile.facebookUsername }}{%endif%}"  style="width: 65%;display: inline-block;float: left;margin-left: 5mm;top: -5.5mm;position: relative;" /><span class="active-box" style="top: -4mm;position: relative;display: inline-block;float: right;vertical-align: middle;"><input type="checkbox" value="1" name="showFacebookName"  style="display: inline-block;" {% if profile.showFacebookName %}checked{% endif %} /><label for="showFacebookName" class="text-muted"  style="display: inline-block;vertical-align: middle;">&nbsp;Make public</label></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <h3 style="margin: 0; padding: 0; padding-bottom: 5px;">Your description <small><a href="/markdown">Markdown</a> supported</small></h3>
        <link rel="stylesheet" href="/static/editor.css">
        <script src="/static/editor.js"></script>
        <script src="/static/marked.js"></script>
                    <textarea name="description"
                        class="form-control input-block-level"
                        placeholder="Public description"
                        rows=10>{{ profile.description }}</textarea>
                </div>
            </div>
        </div>
    </div>
</form>

{%if not hide_login %}
{% if oauth_providers %}
<div class="container lead">
    <div class="row">
        <div class="col-md-8">
            <h1 title="Login">Connected Accounts</h1>
        </div>

    </div>
</div>

<div>
    <div class="info-list">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                  <div class="timeline-centered">
                  {% if not oauth_providers %}
                    <em>No services configured.</em>
                  {% endif %}
                  {% for provider in oauth_providers %}
                    {% set provider_icon = oauth_providers[provider].icon %}
                    {% set provider_full_name = oauth_providers[provider].full_name %}
                    {% set auth = oauth_providers[provider].has_auth %}

                      <div class="timeline-entry">
                        <div class="timeline-entry-inner">
                          <div class="timeline-icon">
                            <span class="fa fa-{{provider_icon}}"></span>

                          </div>
                          <div class="timeline-label">
                            <h2 style="margin-top: -10px; margin-bottom: 0;">
                              {% if auth %}
                                <button data-toggle="modal" data-target="#confirm-disconnect-{{provider}}" class="btn btn-default btn-sm">
                                  Disconnect your {{provider_full_name}} account
                                </button>
                              {% else %}
                                <form action="/connect-oauth" method="POST">
                                  <input type="hidden" name="provider" value="{{provider}}">
                                  <button type="submit" class="btn btn-default btn-sm">
                                    Connect your {{provider_full_name}} account
                                  </button>
                                </form>
                              {% endif %}
                            </h2>
                          </div>
                        </div>
                      </div>
                  {% endfor %}
                  </div>
                </div>
                <div class="col-md-6">
                    <p>
                        Connecting your account on another service allows you to log in with that service.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endif %}
{% for provider in oauth_providers %}
  {% set provider_icon = oauth_providers[provider].icon %}
  {% set provider_full_name = oauth_providers[provider].full_name %}
<div class="modal fade" id="confirm-disconnect-{{provider}}" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
              <h4 class="modal-title" id="myModalLabel">Disconnect Account: {{provider_full_name}}</h4>
            </div>
            <div class="modal-body">
              <p>This action will disconnect your {{provider_full_name}} account from your {{ site_name }} account.</p>
              <p>If you have no alternative way to login, you may lose your {{ site_name }} account.</p>
              <p>Are you sure you with to continue?</p>
            </div>
            <div class="modal-footer">
              <form action="/disconnect-oauth" method="POST">
                <input type="hidden" name="provider" value="{{provider}}">
                <a href="#" class="btn btn-default" data-dismiss="modal">Cancel</a>
                <input type="submit" class="btn btn-primary" value="Disconnect {{provider_full_name}}">
              </form>
            </div>
        </div>
    </div>
</div>
{% endfor %}
{% endblock %}
